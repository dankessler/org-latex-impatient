#+TITLE: org-latex-instant-preview
=Org-latex-instant-preview= provides instant preview of LaTeX snippets via MathJax outputed SVG. Unlike [[https://github.com/fuxialexander/emacs-webkit-katex-render][webkit-katex-render]], this does not need xwidget support.
[[file:img/screenshot.png]]
* Dependencies
  - [[https://github.com/Malabarba/names][Names]]
  - [[https://github.com/mathjax/MathJax-node][MathJax-node]]
  - [[https://github.com/mathjax/mathjax-node-cli/][MathJax-node-cli]]
  - [[https://github.com/tumashu/posframe][posframe]]

* Installation
  You can install =MathJax-node-cli= via ~npm~:
  #+BEGIN_SRC shell
npm install mathjax-node-cli
  #+END_SRC
  You need to set ~org-latex-instant-preview-tex2svg-bin~ to the location of the executable ~tex2svg~.

* Usage
** As Minor Mode
   #+begin_src emacs-lisp
(use-package org-latex-instant-preview
  :defer t
  :hook (org-mode . org-latex-instant-preview-mode)
  :init
  (setq org-latex-instant-preview-tex2svg-bin
        ;; location of tex2svg executable
        "~/node_modules/mathjax-node-cli/bin/tex2svg"))
   #+end_src
   Or just enable minor mode ~org-latex-instant-preview-mode~ manually when it is needed.
   [[file:img/with_mode.gif]]

** Manually
  #+BEGIN_SRC emacs-lisp
(use-package org-latex-instant-preview
  :defer t
  :init
  (setq org-latex-instant-preview-tex2svg-bin
        ;; location of tex2svg executable
        "~/node_modules/mathjax-node-cli/bin/tex2svg"))
  #+END_SRC
  [[file:img/without_mode.gif]]
*** Start Instant Preview
    Put your cursur in some LaTeX fragment or some math environments, and invoke
    #+BEGIN_SRC emacs-lisp
(org-latex-instant-preview-send-latex)
    #+END_SRC
    When you make modifications, an instant preview will be regenerated when Emacs is idle for ~org-latex-instant-preview-delay~ seconds. The preview will NOT be updated when you move your cursor to another LaTeX snippet, but it will be updated if you make some modification to the new snippet. If you do want to update previews instantly when your cursor moves, check [[*Experimental Usage][Experimental Usage]].

*** Stop Instant Preview
    #+BEGIN_SRC emacs-lisp
(org-latex-instant-preview-stop)
    #+END_SRC

* Customization

** Delay Time Before Re-compilation
   Custom ~org-latex-instant-preview-delay~ to change the number of seconds to wait before re-compilation after Emacs is idle.

** Location of ~tex2svg~ Executable
   ~org-latex-instant-preview-tex2svg-bin~

** Scale of Preview
   ~org-latex-instant-preview-scale~. In the current implementation, the scaled version will be blurred. This is due to limitations in the way Emacs handles SVG pictures. In the future, a custom version of ~tex2svg~ will be implemented to use scale by =MathJax= directly.

* License
  This piece work is licensed under UNLICENSE.
