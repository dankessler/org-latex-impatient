#+TITLE: org-latex-instant-preview
=Org-latex-instant-preview= provides instant preview of LaTeX snippets via MathJax outputed SVG. Unlike [[https://github.com/fuxialexander/emacs-webkit-katex-render][webkit-katex-render]], this does not need xwidget support.
[[file:img/screenshot.png]]
* Dependencies
  - [[https://github.com/Malabarba/names][Names]]
  - [[https://github.com/mathjax/MathJax-node][MathJax-node]]
  - [[https://github.com/mathjax/mathjax-node-cli/][MathJax-node-cli]]
  - [[https://github.com/tumashu/posframe][posframe]]

* Installation
  You can install =MathJax-node-cli= via ~npm~:
  #+BEGIN_SRC shell
npm install mathjax-node-cli
  #+END_SRC
  You need to set ~org-latex-instant-preview-tex2svg-bin~ to the location of the executable ~tex2svg~.

* Usage
   #+begin_src emacs-lisp
(use-package org-latex-instant-preview
  :defer t
  :hook (org-mode . org-latex-instant-preview-mode)
  :init
  (setq org-latex-instant-preview-tex2svg-bin
        ;; location of tex2svg executable
        "~/node_modules/mathjax-node-cli/bin/tex2svg"))
   #+end_src
   Or just enable minor mode ~org-latex-instant-preview-mode~ manually when it is needed.
   [[file:img/with_mode.gif]]

* Customization
   - ~org-latex-instant-preview-delay~: change the number of seconds to wait before re-compilation after Emacs is idle. Default to be 0.1.
   - ~org-latex-instant-preview-tex2svg-bin~:  set the location of ~tex2svg~ executable.
   - ~org-latex-instant-preview-scale~: set the scale of the preview. Due to limitations in the way Emacs handles SVG pictures, it is implemented by manipulating SVG directly.
   - ~org-latex-instant-preview-posframe-position-handler~: set the posframe position handler.
       You might want to use ~posframe-poshandler-point-bottom-left-corner~ for showing it using the end point of the current LaTeX fragment, or ~posframe-poshandler-point-window-center~ for a position centering right below the end point. Default value is ~org-latex-instant-preview-poshandler~, which uses end point of current LaTeX fragment for inline math, and centering right below the end point otherwise. Check the documentation of ~posframe-show~ for other options.
   - ~org-latex-instant-preview-user-latex-definitions~: custom LaTeX definitions used in the preview. Should be a list of strings. Default: ~'("\\newcommand{\\ensuremath}[1]{#1}")~, which handles ~\ensuremath~ correctly for =MathJax=. In general, it is recommended to add your custom LaTeX command via the following:
     #+BEGIN_SRC org
,#+LATEX_HEADER: \newcommand{\someNewCommand}{Some Definition}
     #+END_SRC                                                                                                                                                                                                     

* Known Issue
  - Sometimes the posframe buffer is slightly smaller than the rendered preview, causing the bottom part of the preview not showing.

* License
  This piece work is licensed under UNLICENSE.
